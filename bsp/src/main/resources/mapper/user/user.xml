<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="user">
	
		<sql id="userWhere">
		<where>
				<if test="sval != null and sval !=''">
					<if test="stype == 'all'">
					 	id LIKE '%${sval}%' OR name LIKE '%${sval}%'
					</if>
					<if test="stype != 'all'">
						${stype} LIKE '%${sval}%'
					</if>	
				</if>
			</where>
		</sql>
		
		<select id="selectAll" resultType="user.UserVo" parameterType="user.UserVo">
			SELECT * FROM user 
			<include refid="userWhere"/>
			ORDER BY ${orderby} ${direct}			
			LIMIT ${strIdx},${pageRow} 
		</select>
		
		<select id="count" resultType="int" parameterType="user.UserVo">
			SELECT COUNT(*) FROM user
				<include refid="userWhere"/>
		</select>
		
	 	<select id="detail" resultType="user.UserVo" parameterType="user.UserVo" >
			SELECT * FROM user where no= #{no}
		</select>
		
	
		<insert id="insert" parameterType="user.UserVo">
			INSERT INTO user (M_ID,M_PWD,M_Name,M_Email,M_Email_d,M_Tel,M_Zipcord,M_Addr1,M_Addr2,gender,M_regdate,M_Point,M_Delflag,M_Deldate) 
			VALUES( #{M_ID}, md5(#{M_PWD}),#{M_Name},#{M_Email},#{M_Email_d},#{M_Tel},#{M_Zipcord},#{M_Addr1},#{M_Addr2},#{gender}, Now(),0,'n',0 )
		</insert>
		<update id="update" parameterType="user.UserVo">
			UPDATE user SET
				pwd=md5(#{pwd}),email=#{email}
				,tel=#{tel},zipcode=#{zipcode} 
				,addr1=#{addr1},addr2=#{addr2}
				 
			WHERE no=#{no}
		</update>	
		
		<delete id="delete" parameterType="user.UserVo">
			DELETE FROM user WHERE no=#{no}
		</delete>	
		
		<select id="join" parameterType="user.UserVo">
		  
		</select>
		<select id="isDuplicateld" resultType="int" parameterType="user.UserVo">
			SELECT count(*) from user WHERE M_ID=#{M_ID}
		</select>
		
	</mapper>